<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Nebula Idle</title>
<link href="https://fonts.googleapis.com/css2?family=Creepster&display=swap" rel="stylesheet">
<style>
body{margin:0;font-family:'Creepster',cursive;background:radial-gradient(circle,#0a0015,#000);color:#d0c0ff}
#topBar{padding:15px;background:rgba(10,0,30,.95);position:sticky;top:0;border-bottom:2px solid #aa00ff}
button{background:linear-gradient(135deg,#6a00ff,#c300ff);border:none;padding:6px 12px;border-radius:8px;color:#fff;margin:3px;cursor:pointer}
.tabButton.active{background:#ff00aa}
#tabs{display:flex;justify-content:center;gap:6px;padding:10px}
#content>div{display:none;padding:10px}
#content>div.active{display:block}
.item{background:rgba(30,0,60,.7);border:1px solid #6a00ff;padding:8px;border-radius:8px;margin:6px 0}
.equipped{border:2px solid gold}
.common{color:#ddd}.uncommon{color:#6effa3}.rare{color:#4fc3ff}.epic{color:#c77dff}.legendary{color:gold}.mythic{color:#ff4fd8}.cosmic{color:#00f7ff}
.eternal{color:#ffffff;text-shadow:0 0 10px #fff,0 0 20px #00f7ff}
#chestIcon{font-size:90px;text-align:center;cursor:pointer}
.shop-card{display:flex;justify-content:space-between;align-items:center;background:rgba(20,0,40,.7);border:1px solid #9a3cff;padding:8px;border-radius:8px;margin:6px 0}
</style>
</head>
<body>

<div id="topBar">
<div>Para: <span id="money"></span></div>
<div>Takƒ±lƒ± G√º√ß: <span id="power"></span></div>
<div>Slot: <span id="slots"></span></div>
<div>Rebirth: <span id="rebirth"></span> | Nebula: <span id="nebula"></span></div>

<div id="chestIcon">üóùÔ∏è</div>

<div style="text-align:center">
<button id="autoEquipBtn">Auto Equip</button>
<button id="rebirthBtn">Rebirth</button>
<button id="resetBtn">Reset</button>
</div>
</div>

<div id="tabs">
<button class="tabButton active" data-tab="inventory">Envanter</button>
<button class="tabButton" data-tab="shop">Maƒüaza</button>
<button class="tabButton" data-tab="ach">Ba≈üarƒ±lar</button>
</div>

<div id="content">
<div id="inventory" class="active"><div id="invList"></div></div>
<div id="shop"><div id="shopItems"></div></div>
<div id="ach"><div id="achList"></div></div>
</div>

<script>
/* ================= STATE ================= */
let money=1000;
let rebirth=0;
let nebula=0;
let inventory=[];
let maxSlots=3;
let invCap=40;

const SAVE="nebulaBig";

/* ================= HELPERS ================= */
const $=id=>document.getElementById(id);

/* ================= ITEM POOL ================= */
const itemNames=[
"Reakt√∂r","Kristal","Drone","Motor","√áekirdek","Yƒ±ldƒ±z Haritasƒ±","Antimadde",
"Void Par√ßasƒ±","Enerji H√ºcresi","Nano √áip","Galaktik Di≈üli","Plazma",
"Singularity","Zaman Tozu","Nebula Kalbi"
];

/* ================= RARITY ================= */
const rarities=[
{name:'common',chance:40,multi:1},
{name:'uncommon',chance:25,multi:1.5},
{name:'rare',chance:15,multi:2},
{name:'epic',chance:10,multi:3},
{name:'legendary',chance:6,multi:6},
{name:'mythic',chance:3,multi:10},
{name:'cosmic',chance:1,multi:25}
];

function rollRarity(){
    // ETERNAL check (5 milyon)
    if(Math.floor(Math.random()*5000000)===1){
        return {name:'eternal',multi:200};
    }

    let r=Math.random()*100,sum=0;
    for(const x of rarities){sum+=x.chance;if(r<=sum)return x;}
    return rarities[0];
}

/* ================= POWER ================= */
function equipped(){return inventory.filter(i=>i.equipped);}
function getPower(){return equipped().reduce((a,b)=>a+b.power,0);}

/* ================= UI ================= */
function updateUI(){
    $('money').textContent=Math.floor(money);
    $('power').textContent=Math.floor(getPower());
    $('rebirth').textContent=rebirth;
    $('nebula').textContent=nebula;
    $('slots').textContent=equipped().length+" / "+maxSlots;

    const list=$('invList'); list.innerHTML='';
    inventory.forEach((i,idx)=>{
        const d=document.createElement('div');
        d.className='item '+i.rarity+(i.equipped?' equipped':'');

        d.innerHTML=`<b>${i.name}</b> (${i.rarity})<br>G√º√ß ${i.power}`;

        if(i.rarity!=='eternal'){
            const sell=document.createElement('button');
            sell.textContent='Sat';
            sell.onclick=()=>{
                money+=Math.floor(i.power*5);
                inventory.splice(idx,1);
                updateUI(); save();
            };
            d.appendChild(sell);
        }

        const eq=document.createElement('button');
        eq.textContent=i.equipped?'√áƒ±kar':'Tak';
        eq.onclick=()=>{
            if(!i.equipped && equipped().length>=maxSlots){alert("Slot dolu");return;}
            i.equipped=!i.equipped; updateUI(); save();
        };

        d.appendChild(eq);
        list.appendChild(d);
    });

    renderAch();
}

/* ================= CHEST ================= */
function chestCost(){
    return Math.floor(100*Math.pow(1.25,rebirth));
}

function openChest(){
    if(inventory.length>=invCap){alert("Envanter dolu");return;}
    const cost=chestCost();
    if(money<cost){alert("Yetmez");return;}
    money-=cost;

    const rar=rollRarity();
    let power=Math.floor((Math.random()*15+5)*rar.multi);

    // rebirth bonus
    power=Math.floor(power*Math.pow(1.2,rebirth));

    inventory.push({
        name:itemNames[Math.floor(Math.random()*itemNames.length)],
        rarity:rar.name,
        power,
        equipped:false,
        keep: rar.name==='eternal'
    });

    updateUI(); save();
}

/* ================= AUTO EQUIP ================= */
function autoEquip(){
    inventory.forEach(i=>i.equipped=false);
    inventory.sort((a,b)=>b.power-a.power)
    .slice(0,maxSlots)
    .forEach(i=>i.equipped=true);
}

/* ================= SHOP ================= */
function renderShop(){
    const div=$('shopItems'); div.innerHTML='';

    const slotCost=Math.floor(500*Math.pow(1.8,maxSlots-3));
    const c=document.createElement('div');
    c.className='shop-card';
    c.innerHTML=`<div>+1 Slot<br>$${slotCost}</div>`;
    const b=document.createElement('button');
    b.textContent='Al';
    b.onclick=()=>{
        if(money<slotCost){alert("Yetmez");return;}
        money-=slotCost; maxSlots++;
        updateUI(); save();
    };
    c.appendChild(b);
    div.appendChild(c);

    const capCost=1000;
    const c2=document.createElement('div');
    c2.className='shop-card';
    c2.innerHTML=`<div>+10 Envanter<br>$${capCost}</div>`;
    const b2=document.createElement('button');
    b2.textContent='Al';
    b2.onclick=()=>{
        if(money<capCost){alert("Yetmez");return;}
        money-=capCost; invCap+=10;
        updateUI(); save();
    };
    c2.appendChild(b2);
    div.appendChild(c2);
}

/* ================= REBIRTH ================= */
function rebirthCost(){
    return Math.floor(500*Math.pow(1.4,rebirth));
}

$('rebirthBtn').onclick=()=>{
    if(getPower()<rebirthCost()){alert("Daha g√º√ßl√º ol");return;}

    rebirth++;
    nebula++;

    // eternal itemleri koru
    inventory=inventory.filter(i=>i.keep);

    money=1000;
    updateUI(); save();
};

/* ================= ACHIEVEMENTS ================= */
const ach=[
{t:"ƒ∞lk rebirth",c:()=>rebirth>=1},
{t:"10 rebirth",c:()=>rebirth>=10},
{t:"Eternal bul",c:()=>inventory.some(i=>i.rarity==='eternal')},
{t:"1M para",c:()=>money>=1e6}
];

function renderAch(){
    const div=$('achList'); div.innerHTML='';
    ach.forEach(a=>{
        const d=document.createElement('div');
        d.className='item';
        d.textContent=(a.c()?"‚úÖ ":"‚¨ú ")+a.t;
        div.appendChild(d);
    });
}

/* ================= IDLE ================= */
setInterval(()=>{
    money+=getPower();
    updateUI();
},1000);

/* ================= SAVE LOAD ================= */
function save(){
    localStorage.setItem(SAVE,JSON.stringify({
        money,rebirth,nebula,inventory,maxSlots,invCap
    }));
}
function load(){
    const d=localStorage.getItem(SAVE);
    if(!d)return;
    const s=JSON.parse(d);
    money=s.money??money;
    rebirth=s.rebirth??rebirth;
    nebula=s.nebula??nebula;
    inventory=s.inventory??inventory;
    maxSlots=s.maxSlots??maxSlots;
    invCap=s.invCap??invCap;
}

/* ================= TABS ================= */
document.querySelectorAll('.tabButton').forEach(b=>{
    b.onclick=()=>{
        document.querySelectorAll('.tabButton').forEach(x=>x.classList.remove('active'));
        b.classList.add('active');
        document.querySelectorAll('#content>div').forEach(d=>d.classList.remove('active'));
        $(b.dataset.tab).classList.add('active');
    };
});

/* ================= INIT ================= */
$('chestIcon').onclick=openChest;
$('autoEquipBtn').onclick=()=>{autoEquip();updateUI();save();}
$('resetBtn').onclick=()=>{localStorage.removeItem(SAVE);location.reload();}

load();
renderShop();
updateUI();
</script>
</body>
</html>